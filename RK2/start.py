# –∑–∞–ø—É—Å–∫.py
import unittest
import io
import sys
from tests import TestOrchestralManager


def run_tdd_demo():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∞ TDD (Test-Driven Development)"""
    print("=" * 60)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø TDD (–†–ê–ó–†–ê–ë–û–¢–ö–ê –ß–ï–†–ï–ó –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï)")
    print("=" * 60)

    print("\nüìã –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ü–†–û–ì–†–ê–ú–ú–ï:")
    print("1. –û—Ä–∫–µ—Å—Ç—Ä—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ '–ê' –∏ –∏—Ö –¥–∏—Ä–∏–∂—ë—Ä—ã")
    print("2. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –¥–∏—Ä–∏–∂—ë—Ä–∞ –≤ –∫–∞–∂–¥–æ–º –æ—Ä–∫–µ—Å—Ç—Ä–µ")
    print("3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å–≤—è–∑–∏ –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –æ—Ä–∫–µ—Å—Ç—Ä–æ–≤")

    print("\nüîß –≠–¢–ê–ü–´ TDD:")
    print("1. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è")
    print("2. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç")
    print("3. –ù–∞–ø–∏—Å–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞")
    print("4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç")
    print("5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–æ–¥–∞ (—É–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏)")
    print("6. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ü–∏–∫–ª –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è")

    print("\n" + "=" * 60)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:")
    print("=" * 60)

    # –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º –≤—ã–≤–æ–¥ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    old_stdout = sys.stdout
    sys.stdout = io.StringIO()

    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
    suite = unittest.TestLoader().loadTestsFromTestCase(TestOrchestralManager)
    runner = unittest.TextTestRunner(stream=sys.stdout, verbosity=2)
    result = runner.run(suite)

    # –ü–æ–ª—É—á–∞–µ–º –≤—ã–≤–æ–¥
    test_output = sys.stdout.getvalue()
    sys.stdout = old_stdout

    # –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    print(test_output)

    print("=" * 60)
    print("–ò–¢–û–ì–ò:")
    print(f"–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: {result.testsRun}")
    print(f"–£—Å–ø–µ—à–Ω–æ: {result.testsRun - len(result.failures) - len(result.errors)}")

    if len(result.failures) > 0:
        print(f"–ü—Ä–æ–≤–∞–ª–µ–Ω–æ: {len(result.failures)}")
        for test, traceback in result.failures:
            print(f"\n‚ùå –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω: {test}")

    if len(result.errors) > 0:
        print(f"–û—à–∏–±–æ–∫: {len(result.errors)}")

    if result.wasSuccessful():
        print("\nüéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!")
        print("–ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.")
    else:
        print("\n‚ö†Ô∏è –ù–ï–û–ë–•–û–î–ò–ú–û –ò–°–ü–†–ê–í–ò–¢–¨ –ö–û–î –î–õ–Ø –ü–†–û–•–û–ñ–î–ï–ù–ò–Ø –í–°–ï–• –¢–ï–°–¢–û–í")

    print("=" * 60)


def run_main_code():
    """–ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
    print("\n" + "=" * 60)
    print("–ó–ê–ü–£–°–ö –û–°–ù–û–í–ù–û–ô –ü–†–û–ì–†–ê–ú–ú–´:")
    print("=" * 60)

    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É
    from code import main
    main()


if __name__ == "__main__":
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è TDD –ø–æ–¥—Ö–æ–¥–∞
    run_tdd_demo()

    # –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
    run_main_code()

    print("\n" + "=" * 60)
    print("–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ó–ê–ü–£–°–ö–£:")
    print("=" * 60)
    print("1. python code.py          - –∑–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã")
    print("2. python tests.py        - –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤")
    print("3. python start.py       - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è TDD –∏ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
